#!/bin/bash
# ___________________________________________________________________________ #
#                                                                             #
#       ReadLog -- Open a pager to follow the log output generated by the AS. #
#                                                                             #
#                                                                             #
#    Licensed under the Apache License, Version 2.0 (the "License");          #
#    you may not use this file except in compliance with the License.         #
#    You may obtain a copy of the License at                                  #
#                                                                             #
#        http://www.apache.org/licenses/LICENSE-2.0                           #
#                                                                             #
#    Unless required by applicable law or agreed to in writing, software      #
#    distributed under the License is distributed on an "AS IS" BASIS,        #
#    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. #
#    See the License for the specific language governing permissions and      #
#    limitations under the License.                                           #
# ___________________________________________________________________________ #
#                                                                             #
#                                                                             #
# Copyright 2007, lhunath                                                     #
#   * http://lhunath.lyndir.com                                               #
#   * Maarten Billemont.                                                      #
#                                                                             #
source "${0%/*}/bashlib"                                                      #
scripts="${0%/*}"; [[ $scripts = /* ]] || scripts=$PWD/$scripts
distribution=$(cd "$scripts/.."; echo "${PWD##*/}")
source "$scripts/bashlib"


# Notify the user if the distribution is not running anymore.
if ! [[ -f "$scripts/jboss.pid" && $(<"$scripts/jboss.pid") ]]; then
    emit -y "The distribution '$distribution' is not running (anymore)!"
    read -n1 -t2
fi


# Use the default pager for reading the log file.
if [[ -f "$scripts/../jboss/server/default/log/jboss.log" ]]; then
    less +F "$scripts/../jboss/server/default/log/jboss.log"
else
    emit -r "Log file for '$distribution' not found."
fi
